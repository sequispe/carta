<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carta Digital</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family: Arial, Helvetica, sans-serif;
  background:#f7f3f0;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ TELEPROMPTER â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#teleprompter{
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 42px;
  background: #806250;
  color: #fff;
  overflow: hidden;
  z-index: 3000;
  display: flex;
  align-items: center;
}

#tele-text{
  position: absolute;
  white-space: nowrap;
  font-weight: 600;
  font-size: 14px;
  will-change: transform;
}

.oculto{
  display: none;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ CONTENIDO â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#contenido{
  padding:60px 16px 16px; /* deja espacio al teleprompter */
}

.producto{
  background:#fff;
  border-radius:8px;
  padding:12px;
  margin-bottom:12px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}

.producto img{
  max-width:100%;
  border-radius:6px;
}

.nombre{font-weight:bold;font-size:18px}
.descripcion{font-size:14px;color:#555;margin:6px 0}
.precio{font-weight:bold;color:#806250}
</style>
</head>

<body>

<!-- TELEPROMPTER -->
<div id="teleprompter" class="oculto">
  <div id="tele-text"></div>
</div>


<!-- CARTA -->
<div id="contenido">
  <div id="lista"></div>
</div>

<script>
fetch("productos.json")
  .then(r => r.json())
  .then(cfg => {
    if (!cfg.activo) return;
    if (!cfg.mensajes || cfg.mensajes.length === 0) return;

    const tele = document.getElementById("teleprompter");
    const text = document.getElementById("tele-text");

    tele.classList.remove("oculto");

    let index = 0;
    const velocidad = cfg.velocidad || 22;

    function iniciarMensaje(){
      text.textContent = cfg.mensajes[index];

      // esperar a que el navegador calcule el ancho
      requestAnimationFrame(() => {
        const anchoTexto = text.offsetWidth;
        const anchoPantalla = window.innerWidth;

        let x = anchoPantalla;

        function mover(){
          x -= velocidad / 10;
          text.style.transform = `translateX(${x}px)`;

          if (x < -anchoTexto){
            index = (index + 1) % cfg.mensajes.length;
            iniciarMensaje(); // ðŸ” siguiente mensaje
            return;
          }
          requestAnimationFrame(mover);
        }

        mover();
      });
    }

    iniciarMensaje();
  })
  .catch(err => console.error("Teleprompter error", err));
</script>


</body>
</html>
