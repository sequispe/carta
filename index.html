<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carta Digital</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family: Arial, Helvetica, sans-serif;
  background:#f7f3f0;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ TELEPROMPTER â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#teleprompter{
  position: fixed;
  top:0;
  left:0;
  width:100%;
  height:44px;
  background:#111;
  color:#fff;
  overflow:hidden;
  display:none;
  z-index:9999;
}

#tele-text{
  white-space: nowrap;
  position:absolute;
  left:100%;
  top:50%;
  transform: translateY(-50%);
  font-size:16px;
  padding-left:100%;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ CONTENIDO â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#contenido{
  padding:60px 16px 16px; /* deja espacio al teleprompter */
}

.producto{
  background:#fff;
  border-radius:8px;
  padding:12px;
  margin-bottom:12px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}

.producto img{
  max-width:100%;
  border-radius:6px;
}

.nombre{font-weight:bold;font-size:18px}
.descripcion{font-size:14px;color:#555;margin:6px 0}
.precio{font-weight:bold;color:#806250}
</style>
</head>

<body>

<!-- TELEPROMPTER -->
<div id="teleprompter">
  <div id="tele-text"></div>
</div>

<!-- CARTA -->
<div id="contenido">
  <div id="lista"></div>
</div>

<script>
const JSON_URL = "productos.json";

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ TELEPROMPTER â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function iniciarTeleprompter(mensaje, velocidad = 22){
  const tele = document.getElementById("teleprompter");
  const text = document.getElementById("tele-text");

  text.textContent = mensaje;
  tele.style.display = "block";

  let x = window.innerWidth;
  const anchoTexto = text.offsetWidth;

  function animar(){
    x -= velocidad / 10;
    if(x < -anchoTexto) x = window.innerWidth;
    text.style.transform = `translate(${x}px, -50%)`;
    requestAnimationFrame(animar);
  }
  animar();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ RENDER PRODUCTOS â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderProductos(productos){
  const lista = document.getElementById("lista");
  lista.innerHTML = "";

  productos.forEach(p => {
    const div = document.createElement("div");
    div.className = "producto";

    div.innerHTML = `
      ${p.imagen ? `<img src="${p.imagen}">` : ""}
      <div class="nombre">${p.nombre || ""}</div>
      <div class="descripcion">${p.descripcion || ""}</div>
      <div class="precio">$${p.precio || ""}</div>
    `;

    lista.appendChild(div);
  });
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
fetch(JSON_URL)
  .then(r => r.json())
  .then(productos => {

    if(!Array.isArray(productos) || productos.length === 0) return;

    /* ðŸ‘‰ 1ï¸âƒ£ PRIMER ITEM = TELEPROMPTER */
    const teleItem = productos[0];

    if(teleItem.descripcion && teleItem.descripcion.trim() !== ""){
      iniciarTeleprompter(teleItem.descripcion, 22);
    }

    /* ðŸ‘‰ 2ï¸âƒ£ RESTO = CARTA */
    const productosCarta = productos.slice(1);
    renderProductos(productosCarta);

  })
  .catch(err => console.error("Error cargando productos", err));
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ TELEPROMPTER â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function iniciarTeleprompter(mensaje, velocidad = 22){
  const tele = document.getElementById("teleprompter");
  const text = document.getElementById("tele-text");

  text.textContent = mensaje;
  tele.style.display = "block";

  // Esperamos un frame para que el navegador calcule el ancho real del texto
  requestAnimationFrame(() => {
    let x = window.innerWidth;
    const anchoTexto = text.offsetWidth;

    function animar(){
      x -= velocidad / 10;

      // cuando termina de salir COMPLETO por la izquierda, vuelve a empezar
      if (x < -anchoTexto - 50) {
        x = window.innerWidth + 50; // pequeÃ±o margen para que sea suave
      }

      text.style.transform = `translate(${x}px, -50%)`;
      requestAnimationFrame(animar);
    }

    animar();
  });
}
</script>

</body>
</html> 
