<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carta digital</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --tele-h: 42px;
}

/* ===== RESET ===== */
*{ box-sizing: border-box; margin:0; padding:0; }

body{
  font-family: 'Poppins', sans-serif;
  background: #f5f2ee;
  color:#3b2314;
  padding-top: var(--tele-h);
}

/* ===== TELEPROMPTER ===== */
#teleprompter{
  position: fixed;
  top:0;
  left:0;
  width:100%;
  height: var(--tele-h);
  background:#806250;
  color:#fff;
  overflow:hidden;
  z-index:9999;
  display:none;
  align-items:center;
}

#tele-text{
  white-space: nowrap;
  padding-left:100%;
  font-weight:600;
  font-size:14px;
}

/* ===== HEADER ===== */
header{
  width:100%;
  max-height:220px;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
}

header img{
  width:100%;
  height:auto;
  max-height:220px;
  object-fit:contain;
}

/* ===== DEMO CONTENT ===== */
main{
  padding:20px;
}

.banner{
  background:#fff;
  padding:14px 20px;
  border-radius:12px;
  display:inline-block;
  margin-top:20px;
  font-size:1.2rem;
  font-weight:600;
}
</style>
</head>

<body>

<!-- TELEPROMPTER -->
<div id="teleprompter">
  <div id="tele-text"></div>
</div>

<!-- HEADER -->
<header>
  <img src="img/logi1.jpg" alt="Logo">
</header>

<!-- CONTENIDO DEMO -->
<main>
  <div class="banner">¬°Bienvenidos!</div>
</main>

<script>
/* ===== TELEPROMPTER LOGIC ===== */
fetch("teleprompter.json?cache=" + Date.now())
  .then(res => res.json())
  .then(cfg => {

    if (!cfg.activo) return;
    if (!cfg.mensaje || cfg.mensaje.trim() === "") return;

    const tele = document.getElementById("teleprompter");
    const text = document.getElementById("tele-text");

    text.textContent = cfg.mensaje;
    tele.style.display = "flex";

    const velocidad = cfg.velocidad || 22;

    let x = window.innerWidth;

    function mover(){
      x -= velocidad / 10;
      if (x < -text.offsetWidth) x = window.innerWidth;
      text.style.transform = `translateX(${x}px)`;
      requestAnimationFrame(mover);
    }

    mover();
  })
  .catch(err => console.error("Teleprompter error:", err));<script>
document.addEventListener("DOMContentLoaded", () => {

  /* ================= SONIDO ================= */

  let sonidoActivo = localStorage.getItem("sonido") !== "off";
  const btnSound = document.getElementById("btnSound");

  if (btnSound) {
    btnSound.textContent = sonidoActivo ? "üîä" : "üîá";
    btnSound.addEventListener("click", () => {
      sonidoActivo = !sonidoActivo;
      localStorage.setItem("sonido", sonidoActivo ? "on" : "off");
      btnSound.textContent = sonidoActivo ? "üîä" : "üîá";
    });
  }

  function playSound(src, volume = 0.4) {
    if (!sonidoActivo) return;
    const audio = new Audio(src);
    audio.volume = volume;
    audio.play().catch(() => {});
  }

  /* ================= CONFIG ================= */

  const USER = "sequispe";
  const REPO = "carta";
  let idiomaActual = localStorage.getItem("idioma") || "es";

  const btnEs = document.getElementById("btn-es");
  const btnEn = document.getElementById("btn-en");
  const btnPt = document.getElementById("btn-pt");
  const banner = document.getElementById("banner-text");

  const categoryContainer = document.getElementById("category-buttons");
  const productList = document.getElementById("product-list");
  const searchInput = document.getElementById("search");
  const btnSearch = document.getElementById("btnSearch");
  const btnUp = document.getElementById("btnUp");

  let productos = [];

  function scrollToProducts() {
    productList.scrollIntoView({ behavior: "smooth" });
  }

  /* ================= IDIOMAS ================= */

  function actualizarBotones() {
    btnEs.classList.toggle("active", idiomaActual === "es");
    btnEn.classList.toggle("active", idiomaActual === "en");
    btnPt.classList.toggle("active", idiomaActual === "pt");

    if (idiomaActual === "es") banner.textContent = "¬°Bienvenidos a Tilo Caf√© Ag√ºero 2298!";
    if (idiomaActual === "en") banner.textContent = "Welcome to Tilo Caf√© Ag√ºero 2298!";
    if (idiomaActual === "pt") banner.textContent = "Bem-vindo ao Tilo Caf√© Ag√ºero 2298!";
  }

  /* ================= LOAD ================= */

  async function load() {
    actualizarBotones();

    let filename = "productos.json";
    if (idiomaActual === "en") filename = "productos-en.json";
    if (idiomaActual === "pt") filename = "productos-port.json";

    const URL = `https://raw.githubusercontent.com/${USER}/${REPO}/main/${filename}`;

    try {
      const res = await fetch(URL, { cache: "no-store" });
      if (!res.ok) throw new Error("Error cargando productos");

      const data = await res.json();

      productos = data.map(p => ({
        nombre:
          idiomaActual === "es" ? (p.nombre || p.nome) :
          idiomaActual === "en" ? (p.name || p.nome) :
          p.nome,

        descripcion:
          idiomaActual === "es" ? (p.descripcion || p.descricao) :
          idiomaActual === "en" ? (p.description || p.descricao) :
          p.descricao,

        precio: p.precio || p.preco || p.price,
        imagen: p.imagen || p.imagem || p.image,

        categoria:
          idiomaActual === "es" ? p.categoria :
          idiomaActual === "en" ? (p.category || p.categoria) :
          p.categoria
      }));

      renderCategories();
      renderProducts("Todos");

    } catch (e) {
      console.error(e);
      productList.innerHTML = `<div class="msg">‚ö†Ô∏è No se pudieron cargar los productos.</div>`;
    }
  }

  /* ================= CATEGOR√çAS ================= */

  function renderCategories() {
    const categorias = ["Todos", ...new Set(productos.map(p => p.categoria))];
    categoryContainer.innerHTML = "";

    categorias.forEach(cat => {
      const btn = document.createElement("button");
      btn.textContent = cat;
      btn.addEventListener("click", () => {
        playSound("sounds/categor√≠as.wav");
        renderProducts(cat);
        scrollToProducts();
      });
      categoryContainer.appendChild(btn);
    });
  }

  /* ================= PRODUCTOS ================= */

  function renderProducts(categoria) {
    productList.innerHTML = "";

    const lista = categoria === "Todos"
      ? productos
      : productos.filter(p => p.categoria === categoria);

    if (lista.length === 0) {
      productList.innerHTML = `<div class="msg">No hay productos disponibles.</div>`;
      return;
    }

    lista.forEach(p => {
      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        <img src="${p.imagen}" alt="${p.nombre}">
        <h3>${p.nombre}</h3>
        <p>${p.descripcion || ""}</p>
        <span class="price">$${p.precio}</span>
      `;
      productList.appendChild(div);
    });
  }

  /* ================= BUSCAR ================= */

  function buscar() {
    const q = searchInput.value.toLowerCase().trim();

    if (!q) {
      renderProducts("Todos");
      return;
    }

    const res = productos.filter(p =>
      p.nombre.toLowerCase().includes(q) ||
      (p.descripcion || "").toLowerCase().includes(q) ||
      p.categoria.toLowerCase().includes(q)
    );

    if (res.length === 0) {
      productList.innerHTML = `<div class="msg">üîç No se encontraron resultados.</div>`;
      return;
    }

    productList.innerHTML = "";
    res.forEach(p => {
      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `
        <img src="${p.imagen}" alt="${p.nombre}">
        <h3>${p.nombre}</h3>
        <p>${p.descripcion || ""}</p>
        <span class="price">$${p.precio}</span>
      `;
      productList.appendChild(div);
    });

    scrollToProducts();
  }

  btnSearch.addEventListener("click", () => {
    playSound("sounds/buscar.mp3");
    buscar();
  });

  searchInput.addEventListener("keyup", e => {
    if (e.key === "Enter") buscar();
  });

  /* ================= BOT√ìN SUBIR ================= */

  window.addEventListener("scroll", () => {
    btnUp.style.display = window.scrollY > 300 ? "block" : "none";
  });

  btnUp.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

  /* ================= EVENTOS IDIOMA ================= */

  btnEs.addEventListener("click", () => {
    playSound("sounds/idioma.mp3");
    idiomaActual = "es";
    localStorage.setItem("idioma", "es");
    load();
  });

  btnEn.addEventListener("click", () => {
    playSound("sounds/idioma.mp3");
    idiomaActual = "en";
    localStorage.setItem("idioma", "en");
    load();
  });

  btnPt.addEventListener("click", () => {
    playSound("sounds/idioma.mp3");
    idiomaActual = "pt";
    localStorage.setItem("idioma", "pt");
    load();
  });

  /* ================= INIT ================= */

  load();
});

</script>

</body>
</html>
